# 工作区说明

本工作区包含 CCGA（Coherence-Guided Cross-Attention）模块的核心内容和数据集。

---

## 📁 目录结构

```
jsy_dataset_and_model/
│
├── 📊 数据集/
│   ├── merged_complete_dataset_no_augment/    # 原始GPR数据集 (72×151)
│   │   ├── PVC/
│   │   ├── 二面角/
│   │   ├── 含水/
│   │   ├── 多分支/
│   │   ├── 电缆/
│   │   ├── 空洞/
│   │   └── 金属/
│   │       ├── VV/                            # VV极化图像
│   │       ├── VH/                            # VH极化图像
│   │       ├── VV_matrices/                   # VV复数矩阵 (151×72, complex128)
│   │       └── VH_matrices/                   # VH复数矩阵 (151×72, complex128)
│   │
│   ├── tongyi_weidu/                          # 统一维度数据集 (224×224)
│   │   ├── PVC/
│   │   ├── 二面角/
│   │   ├── 含水/
│   │   ├── 多分支/
│   │   ├── 电缆/
│   │   ├── 空洞/
│   │   └── 金属/
│   │       ├── VV_images/                     # VV极化图像 (224×224)
│   │       ├── VH_images/                     # VH极化图像 (224×224)
│   │       ├── VV_matrices/                   # VV复数矩阵 (224×224, complex128)
│   │       ├── VH_matrices/                   # VH复数矩阵 (224×224, complex128)
│   │       └── VV_VH_matrices/                # 交叉相干系数 (224×224, float64)
│   │
│   └── tongyi_weidu_5x/                       # 5倍增强数据集 (224×224)
│       ├── PVC/
│       ├── 二面角/
│       ├── 含水/
│       ├── 多分支/
│       ├── 电缆/
│       ├── 空洞/
│       └── 金属/
│           ├── VV_images/                     # VV极化图像（原始+增强）
│           ├── VH_images/                     # VH极化图像（原始+增强）
│           ├── VV_matrices/                   # VV复数矩阵（原始+增强）
│           ├── VH_matrices/                   # VH复数矩阵（原始+增强）
│           └── VV_VH_matrices/                # 交叉相干系数（原始+增强）
│
├── 🧠 核心代码/
│   └── network_code/
│       ├── modules/
│       │   ├── ccga.py                        # CCGA模块实现
│       │   └── __init__.py
│       ├── README.md                          # 网络代码说明
│       └── __init__.py
│
├── 📝 文档/
│   ├── README.md                              # 项目主文档
│   ├── CCGA模块核心功能详解.md                 # CCGA核心功能详解
│   ├── 工作区说明.md                          # 本文档
│   └── 数据增强说明.md                        # 数据增强说明
│
└── 🛠️ 工具脚本/
    ├── augment_tongyi_weidu.py                # 数据增强脚本
    ├── generate_augmentation_report.py        # 生成增强报告
    └── check_dataset.py                       # 数据集检查脚本
```

---

## 📊 数据集说明

### 1. merged_complete_dataset_no_augment（原始数据集）

- **图像尺寸**: 72×151 像素
- **矩阵形状**: 151×72
- **矩阵类型**: complex128（复数）
- **样本数量**: 每类 25 个样本，共 7 类，总计 175 个样本
- **类别**: PVC、二面角、含水、多分支、电缆、空洞、金属

### 2. tongyi_weidu（统一维度数据集）

- **图像尺寸**: 224×224 像素
- **矩阵形状**: 224×224
- **矩阵类型**:
  - VV/VH 矩阵: complex128（复数）
  - VV_VH 矩阵: float64（实数，交叉相干系数）
- **样本数量**: 每类 25 个样本，共 7 类，总计 175 个样本
- **类别**: PVC、二面角、含水、多分支、电缆、空洞、金属
- **特点**: 从原始数据集统一维度而来，保留复数特性

### 3. tongyi_weidu_5x（5倍增强数据集）

- **图像尺寸**: 224×224 像素
- **矩阵形状**: 224×224
- **矩阵类型**:
  - VV/VH 矩阵: complex128（复数）
  - VV_VH 矩阵: float64（实数，交叉相干系数）
- **样本数量**: 每类 150 个样本（25原始 + 125增强），共 7 类，总计 1050 个样本
- **类别**: PVC、二面角、含水、多分支、电缆、空洞、金属
- **增强方法**: 水平翻转、垂直翻转、旋转90°、旋转180°、旋转270°
- **特点**:
  - 从 tongyi_weidu 数据集增强而来
  - 保持复数矩阵特性
  - 增强后重新计算相干矩阵

### 交叉相干系数计算

```python
# VV_VH_matrices 的计算方式
C_VV_VH = |VV .* conj(VH)|
```

其中：
- `VV`: VV极化的复数矩阵
- `VH`: VH极化的复数矩阵
- `conj(VH)`: VH的共轭复数
- `.*`: 逐元素相乘
- `| |`: 取模（绝对值）

---

## 🧠 CCGA 模块

### 核心功能

CCGA（Coherence-Guided Cross-Attention）是一个用于双极化GPR图像分类的注意力模块。

**主要特点**：
1. **双极化融合**: 融合 VV 和 VH 极化数据
2. **物理引导**: 使用相干矩阵提供物理先验知识
3. **自适应门控**: 动态调节数据驱动学习和物理先验的比例

### 门控机制

```python
# 门控融合公式
scores = gate * scores_learned + (1 - gate) * scores_physical
```

- **gate = 1.0**: 完全依赖数据驱动学习
- **gate = 0.5**: 数据学习和物理先验各占一半
- **gate = 0.0**: 完全依赖物理先验

### 代码位置

- **核心实现**: `network_code/modules/ccga.py`
- **详细说明**: `CCGA模块核心功能详解.md`

---

## 📖 文档说明

1. **README.md**: 项目整体介绍和使用说明
2. **CCGA模块核心功能详解.md**: CCGA模块的详细技术文档
3. **工作区说明.md**: 本文档，工作区结构和内容说明

---

## 🔍 数据集对比

| 特性 | merged_complete_dataset_no_augment | tongyi_weidu | tongyi_weidu_5x |
|------|-----------------------------------|--------------|-----------------|
| 图像尺寸 | 72×151 | 224×224 | 224×224 |
| 矩阵形状 | 151×72 | 224×224 | 224×224 |
| VV/VH矩阵类型 | complex128 | complex128 | complex128 |
| 交叉相干矩阵 | ❌ 无 | ✅ 有 (float64) | ✅ 有 (float64) |
| 样本数量 | 175 (25/类) | 175 (25/类) | 1050 (150/类) |
| 增强倍数 | - | - | 6.0x |
| 用途 | 原始数据保存 | 统一维度训练 | 增强数据训练 |

---

## 💡 使用建议

1. **研究原始数据**: 使用 `merged_complete_dataset_no_augment`
2. **小规模训练**: 使用 `tongyi_weidu`（已统一维度，175样本）
3. **大规模训练**: 使用 `tongyi_weidu_5x`（5倍增强，1050样本）
4. **数据增强**: 运行 `python augment_tongyi_weidu.py --factor N` 生成N倍增强数据
5. **CCGA模块**: 参考 `network_code/modules/ccga.py`
6. **技术细节**: 阅读 `CCGA模块核心功能详解.md` 和 `数据增强说明.md`

---

## 🚀 快速开始

### 数据增强

```bash
# 生成5倍增强数据集
python augment_tongyi_weidu.py --factor 5 --output tongyi_weidu_5x

# 生成10倍增强数据集
python augment_tongyi_weidu.py --factor 10 --output tongyi_weidu_10x

# 生成增强报告
python generate_augmentation_report.py
```

### 数据集检查

```bash
# 检查数据集详细信息
python check_dataset.py
```

---

**最后更新**: 2025-11-24

