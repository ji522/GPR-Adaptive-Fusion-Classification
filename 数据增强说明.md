# GPR数据集增强说明

## 📊 数据集信息

### 原始数据集：tongyi_weidu
- **样本数量**: 175个（每类25个）
- **类别**: PVC、二面角、含水、多分支、电缆、空洞、金属（7类）
- **数据维度**: 224×224
- **数据类型**:
  - VV矩阵: complex128（复数）
  - VH矩阵: complex128（复数）
  - VV_VH矩阵: float64（实数，交叉相干系数）
  - VV图像: JPG格式
  - VH图像: JPG格式

---

## 🔧 数据增强方法

### 支持的增强类型

1. **水平翻转 (hflip)**
   - 沿水平轴翻转图像和矩阵
   - 适用于GPR B-scan图像

2. **垂直翻转 (vflip)**
   - 沿垂直轴翻转图像和矩阵
   - 模拟不同扫描方向

3. **旋转90度 (rot90)**
   - 顺时针旋转90度
   - 增加数据多样性

4. **旋转180度 (rot180)**
   - 旋转180度
   - 等效于水平+垂直翻转

5. **旋转270度 (rot270)**
   - 顺时针旋转270度（逆时针90度）
   - 进一步增加多样性

6. **高斯噪声 (noise)**
   - 添加高斯噪声
   - 模拟真实采集中的噪声
   - 对复数矩阵：分别对实部和虚部添加噪声
   - 对图像：添加像素级噪声

---

## 🚀 使用方法

### 基本用法

```bash
# 默认5倍增强
python augment_tongyi_weidu.py

# 指定增强倍数
python augment_tongyi_weidu.py --factor 10

# 指定输入输出目录
python augment_tongyi_weidu.py --input tongyi_weidu --output tongyi_weidu_10x --factor 10
```

### 参数说明

- `--input`: 输入数据集目录（默认: tongyi_weidu）
- `--output`: 输出数据集目录（默认: tongyi_weidu_augmented）
- `--factor`: 增强倍数（默认: 5）

---

## 📁 输出数据结构

```
tongyi_weidu_augmented/
├── PVC/
│   ├── VV_images/
│   │   ├── pvc_data1.jpg                    # 原始样本
│   │   ├── pvc_data1_aug1_hflip.jpg         # 增强样本1：水平翻转
│   │   ├── pvc_data1_aug2_vflip.jpg         # 增强样本2：垂直翻转
│   │   ├── pvc_data1_aug3_rot90.jpg         # 增强样本3：旋转90度
│   │   ├── pvc_data1_aug4_rot180.jpg        # 增强样本4：旋转180度
│   │   └── pvc_data1_aug5_rot270.jpg        # 增强样本5：旋转270度
│   ├── VH_images/
│   │   └── ...（同VV_images）
│   ├── VV_matrices/
│   │   ├── pvc_data1.mat                    # 原始VV矩阵
│   │   ├── pvc_data1_aug1_hflip.mat         # 增强VV矩阵
│   │   └── ...
│   ├── VH_matrices/
│   │   └── ...（同VV_matrices）
│   └── VV_VH_matrices/
│       ├── pvc_data1.mat                    # 原始相干矩阵
│       ├── pvc_data1_aug1_hflip.mat         # 重新计算的相干矩阵
│       └── ...
├── 二面角/
├── 含水/
├── 多分支/
├── 电缆/
├── 空洞/
└── 金属/
```

---

## 🔍 技术细节

### 复数矩阵处理

对于VV和VH的复数矩阵，增强操作同时应用于实部和虚部：

```python
# 水平翻转
augmented_matrix = np.fliplr(complex_matrix)

# 添加噪声
real_noise = np.random.normal(0, 0.01, shape)
imag_noise = np.random.normal(0, 0.01, shape)
noise = real_noise + 1j * imag_noise
augmented_matrix = complex_matrix + noise
```

### 相干矩阵重新计算

增强后的VV_VH相干矩阵需要重新计算：

```python
VV_VH_augmented = |VV_augmented .* conj(VH_augmented)|
```

这确保了相干矩阵与增强后的VV、VH矩阵保持一致。

---

## 📊 增强效果

### 5倍增强（默认）
- 原始样本: 175个
- 增强后样本: 175 × (1 + 5) = 1050个
- 每类样本: 25 × 6 = 150个

### 10倍增强
- 原始样本: 175个
- 增强后样本: 175 × (1 + 6) = 1225个（使用全部6种增强方法）
- 每类样本: 25 × 7 = 175个

---

## ⚠️ 注意事项

1. **数据一致性**: VV和VH矩阵必须同步增强，确保物理意义正确
2. **相干矩阵**: 增强后必须重新计算VV_VH相干矩阵
3. **存储空间**: 增强后数据集大小会显著增加
4. **增强倍数**: 建议不超过10倍，避免过度拟合

---

## 💡 使用建议

1. **训练集增强**: 只对训练集进行增强，测试集保持原始数据
2. **验证效果**: 增强后检查样本质量，确保物理意义合理
3. **适度增强**: 根据实际需求选择合适的增强倍数
4. **保留原始**: 始终保留原始数据集作为备份

---

**创建时间**: 2025-11-24

